(this.webpackJsonpchatdom=this.webpackJsonpchatdom||[]).push([[0],{129:function(e,t,c){},209:function(e,t,c){},210:function(e,t,c){},211:function(e,t,c){},225:function(e,t,c){},372:function(e,t,c){},373:function(e,t,c){},374:function(e,t,c){"use strict";c.r(t);var a=c(2),s=c.n(a),n=c(41),i=c.n(n),o=(c(209),c(10)),r=(c(210),c(129),c(392)),l=c(394),d=(c(211),c(34)),j=d.a.initializeApp({apiKey:"AIzaSyCDvpALb9u1Qn3IXWSNSjP0NtejbWNzsUY",authDomain:"chatdom-54ec5.firebaseapp.com",projectId:"chatdom-54ec5",storageBucket:"chatdom-54ec5.appspot.com",messagingSenderId:"1050566466990",appId:"1:1050566466990:web:d25b78788d10b75656fc3f",measurementId:"G-VHJTWNKJ5Z"}).firestore(),u=d.a.auth(),b=new d.a.auth.GoogleAuthProvider,m=d.a.storage(),h=j,O=c(14),f=c(91),p=c(180),v=c.n(p),x=c(3),g=Object(a.createContext)(),N=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(x.jsx)(g.Provider,{value:Object(a.useReducer)(t,c),children:s})},S=function(){return Object(a.useContext)(g)},_=c(178),y=c.n(_),I=c(70),w=function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e!==(null===t||void 0===t?void 0:t.email)}))[0]},C=function(e){var t,c,s,n,i=e.addNewChat,r=e.id,d=e.users,j=Object(O.f)(),u=S(),b=Object(o.a)(u,2),m=b[0].user,p=(b[1],Object(a.useState)([])),g=Object(o.a)(p,2),N=g[0],_=g[1],C=w(d,m)?w(d,m):null,U=Object(a.useState)(""),R=Object(o.a)(U,2),E=R[0],L=R[1],k=h.collection("rooms").where("users","array-contains",m.email),D=Object(I.a)(k),T=Object(o.a)(D,1)[0],M=Object(I.a)(h.collection("users").where("email","==",C)),A=Object(o.a)(M,1)[0],F=null===A||void 0===A||null===(t=A.docs)||void 0===t||null===(c=t[0])||void 0===c?void 0:c.data();Object(a.useEffect)((function(){j.push("/rooms/".concat(r))}),[r]),Object(a.useEffect)((function(){r&&h.collection("rooms").doc(r).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return L(e.docs.map((function(e){return e.data()})))}))}),[r]),Object(a.useEffect)((function(){h.collection("users").onSnapshot((function(e){return _(e.docs.map((function(e){return e.data().email})))}))}),[]);var J=function(e){return!!T.docs.find((function(t){var c;return(null===(c=t.data().users.find((function(t){return t===e})))||void 0===c?void 0:c.length)>0}))};return i?Object(x.jsxs)("div",{onClick:function(){var e=prompt("Please enter email of the user");N.includes(e)&&y.a.validate(e)&&!J(e)&&e!==m.email?h.collection("rooms").add({users:[m.email,e]}):alert(e+" is NOT RIGESTERED OR ASK USER TO LOGIN")},className:"sidebar_chat fixed",children:[Object(x.jsx)(v.a,{}),Object(x.jsx)("h5",{children:"ENTER EMAIL ID"})]}):Object(x.jsx)(f.b,{to:"/rooms/".concat(r),children:Object(x.jsxs)("div",{className:"sidebar_chat",children:[F?Object(x.jsx)(l.a,{src:null===F||void 0===F?void 0:F.photoURL}):Object(x.jsx)(l.a,{children:C[0]}),Object(x.jsxs)("div",{className:"sidebarchat_info",children:[Object(x.jsx)("h2",{children:null===F||void 0===F?void 0:F.name}),Object(x.jsx)("p",{children:null===(s=E[0])||void 0===s||null===(n=s.message)||void 0===n?void 0:n.substring(0,17)})]})]})})},U=c(181),R=c.n(U),E=function(e){var t=e.sidebar,c=e.closeSidebar,s=Object(a.useState)([]),n=Object(o.a)(s,2),i=n[0],d=n[1],j=S(),b=Object(o.a)(j,2),m=b[0].user;b[1];Object(a.useEffect)((function(){var e=h.collection("rooms").onSnapshot((function(e){return d(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]);return Object(x.jsxs)("div",{onClick:c,className:"sidebar ".concat(t&&"visible"),children:[Object(x.jsxs)("div",{className:"sidebar_header",children:[Object(x.jsxs)("div",{className:"sidebar_headerLeft",children:[Object(x.jsx)(r.a,{children:Object(x.jsx)(l.a,{src:null===m||void 0===m?void 0:m.photoURL})}),Object(x.jsx)("h3",{children:m.displayName})]}),Object(x.jsx)("div",{className:"sidebar_headerRight",children:Object(x.jsxs)(r.a,{onClick:function(){u.signOut()},children:[Object(x.jsx)(R.a,{})," ",Object(x.jsx)("h6",{children:"Log out"})]})})]}),Object(x.jsxs)("div",{className:"sidebar_chats",children:[Object(x.jsx)(C,{addNewChat:!0}),i.map((function(e){if(e.data.users[0]===m.email||e.data.users[1]===m.email)return Object(x.jsx)(C,{id:e.id,users:e.data.users},e.id)}))]})]})},L=(c(225),c(92)),k=c.n(L),D=c(126),T=c.n(D),M=c(127),A=c.n(M),F=c(197),J=c(199),P=c.p+"static/media/bg.0a583fc4.jpg",z=c(195),B=c.n(z),G=c(194),K=c.n(G),Q=(c(372),c(196)),V=c.n(Q),W=function(e){var t=e.roomId,c=Object(a.useState)(null),s=Object(o.a)(c,2),n=s[0],i=s[1],r=Object(a.useState)(0),l=Object(o.a)(r,2),j=l[0],u=l[1],b=S(),O=Object(o.a)(b,2),f=O[0].user,p=(O[1],Object(a.useState)(null)),v=Object(o.a)(p,2),g=v[0],N=v[1];return Object(x.jsx)("div",{className:"upload",children:n?Object(x.jsxs)("div",{className:"preview",children:[Object(x.jsx)(V.a,{className:"preview_close",onClick:function(){i(null)}}),j?Object(x.jsx)(K.a,{type:"balls",color:"red",height:50,width:50,className:"preview_loading"}):Object(x.jsxs)("div",{className:"preview_send",children:[Object(x.jsx)("button",{onClick:function(e){e.preventDefault(),console.log(n.type),n&&m.ref("images/".concat(n.name)).put(n).on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);u(t)}),(function(e){alert(e.message)}),(function(){m.ref("images").child(n.name).getDownloadURL().then((function(e){h.collection("rooms").doc(t).collection("messages").add({timestamp:d.a.firestore.FieldValue.serverTimestamp(),imageUrl:e,name:f.displayName}).then((function(){i(null),u(0)}))}))}))},className:"send_button",children:Object(x.jsx)(k.a,{})}),Object(x.jsx)("img",{src:g,alt:"",className:"preview_image"})]})]}):Object(x.jsxs)("label",{className:"image_input",children:[Object(x.jsx)(B.a,{}),Object(x.jsx)("input",{type:"file",onChange:function(e){"image/jpeg"===e.target.files[0].type||"image/png"===e.target.files[0].type||"image/jpg"===e.target.files[0].type?(i(e.target.files[0]),N(URL.createObjectURL(e.target.files[0]))):alert("This is not a image file")}})]})})},Z=function(e){var t,c,s,n,i,j=e.sidebar,u=e.openSidebar,b=Object(a.useState)(""),m=Object(o.a)(b,2),f=(m[0],m[1],Object(a.useState)("")),p=Object(o.a)(f,2),v=p[0],g=p[1],N=Object(O.g)().roomId,_=Object(a.useState)(""),y=Object(o.a)(_,2),C=(y[0],y[1],Object(a.useState)([])),U=Object(o.a)(C,2),R=U[0],E=U[1],L=S(),D=Object(o.a)(L,2),M=D[0].user,z=(D[1],Object(a.useState)([])),B=Object(o.a)(z,2),G=B[0],K=B[1];Object(a.useEffect)((function(){N&&h.collection("rooms").doc(N).onSnapshot((function(e){var t;return K(null===(t=e.data())||void 0===t?void 0:t.users)}))}),[N]);var Q=w(G,M)?w(G,M):0,V=Object(I.a)(h.collection("users").where("email","==",Q)),Z=Object(o.a)(V,1)[0],Y=null===Z||void 0===Z||null===(t=Z.docs)||void 0===t||null===(c=t[0])||void 0===c?void 0:c.data();Object(a.useEffect)((function(){var e=h.collection("rooms").doc(N).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return E(e.docs.map((function(e){return e.data()})))}));return function(){e()}}),[N]);return Q?Object(x.jsxs)("div",{className:"chat",children:[Object(x.jsxs)("div",{className:"chat_header",children:[Y?Object(x.jsx)(l.a,{src:null===Y||void 0===Y?void 0:Y.photoURL}):Object(x.jsx)(l.a,{children:Q[0]}),Object(x.jsxs)("div",{className:"chat_headerInfo",children:[Object(x.jsx)("h2",{children:null===Y||void 0===Y?void 0:Y.name}),Y?Object(x.jsxs)("p",{children:["last seen"," ",(null===Y||void 0===Y||null===(s=Y.lastseen)||void 0===s?void 0:s.toDate()).toString().slice(0,25)]}):Object(x.jsxs)("p",{children:["last seen"," ",new Date(null===(n=R[R.length-1])||void 0===n||null===(i=n.timestamp)||void 0===i?void 0:i.toDate()).toUTCString().slice(0,26)]})]}),Object(x.jsx)("div",{className:"chat_headerRight",children:Object(x.jsx)(r.a,{onClick:u,className:"slide_button",children:j?Object(x.jsx)(T.a,{}):Object(x.jsx)(A.a,{})})})]}),Object(x.jsx)(J.a,{className:"chat_body",onClick:j&&u,children:Object(x.jsx)(F.a,{children:R.map((function(e,t){var c,a;return e.imageUrl?Object(x.jsxs)("div",{className:"image ".concat(e.name===M.displayName&&"chat_recevier"),children:[Object(x.jsx)("img",{src:e.imageUrl,alt:"Uploaded Images"}),Object(x.jsx)("span",{className:"image_timestamp",children:null===(c=e.timestamp)||void 0===c?void 0:c.toDate().toString().slice(0,25)})]}):Object(x.jsxs)("div",{className:"chat_message ".concat(e.name===M.displayName&&"chat_recevier"),children:[Object(x.jsx)("p",{children:e.message}),Object(x.jsx)("span",{className:"chat_timestamp",children:null===(a=e.timestamp)||void 0===a?void 0:a.toDate().toString().slice(0,25)})]})}))})}),Object(x.jsxs)("div",{className:"chat_footer",children:[Object(x.jsx)(W,{roomId:N}),Object(x.jsxs)("form",{children:[Object(x.jsx)("input",{value:v,onChange:function(e){return g(e.target.value)},type:"text",placeholder:"Type a message"}),Object(x.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),Y&&v&&(h.collection("rooms").doc(N).collection("messages").add({message:v,name:M.displayName,timestamp:d.a.firestore.FieldValue.serverTimestamp()}),g(""))},children:Object(x.jsx)(k.a,{})})]})]})]}):Object(x.jsxs)("div",{className:"chat nochathead",children:[Object(x.jsxs)("div",{className:"chat_header nochat",children:[Object(x.jsx)("img",{className:"chatlogo",src:"https://see.fontimg.com/api/renderfont4/z80eL/eyJyIjoiZnMiLCJoIjo2NiwidyI6MTI1MCwiZnMiOjUzLCJmZ2MiOiIjMDAwMDAwIiwiYmdjIjoiIzg3ODdDQSIsInQiOjF9/Y2hhdGRvbQ/your-dream.png",alt:""}),Object(x.jsx)("div",{className:"chat_headerRight",children:Object(x.jsx)(r.a,{onClick:u,className:"slide_button",children:j?Object(x.jsx)(T.a,{}):Object(x.jsx)(A.a,{})})})]}),Object(x.jsx)("img",{className:"bgimage",src:P,alt:""})]})},Y=c(198),H=(c(373),c(393)),X=function(){var e=S(),t=Object(o.a)(e,2);Object(Y.a)(t[0]);t[1];return Object(x.jsx)("div",{className:"login",children:Object(x.jsxs)("div",{className:"login_container",children:[Object(x.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/e/e3/KakaoTalk_logo.svg",alt:""}),Object(x.jsx)("div",{className:"login_text",children:Object(x.jsx)("h1",{children:"sign in to chatdom"})}),Object(x.jsx)(H.a,{onClick:function(){u.signInWithPopup(b).catch((function(e){return alert(e.message)}))},children:"sign in with google"})]})})},q=c(128),$="SET_USER",ee=function(e,t){switch(t.type){case $:return Object(q.a)(Object(q.a)({},e),{},{user:t.User});default:return e}},te=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),c=t[0],s=t[1],n=S(),i=Object(o.a)(n,2),r=i[0].user,l=i[1];Object(a.useEffect)((function(){r&&h.collection("users").doc(r.uid).set({name:r.displayName,email:r.email,lastseen:d.a.firestore.FieldValue.serverTimestamp(),photoURL:r.photoURL,login:!0},{merge:!0})}),[r]),Object(a.useEffect)((function(){u.onAuthStateChanged((function(e){l(e?{type:$,User:e}:{type:$,User:null})}))}),[]);var j=function(){s(!c)};return Object(x.jsx)("div",{className:"app",children:r?Object(x.jsx)("div",{className:"app_body",children:Object(x.jsxs)(f.a,{children:[Object(x.jsx)(E,{sidebar:c,closeSidebar:function(){s(!1)}}),Object(x.jsxs)(O.c,{children:[Object(x.jsx)(O.a,{path:"/rooms/:roomId",children:Object(x.jsx)(Z,{sidebar:c,openSidebar:j})}),Object(x.jsx)(O.a,{path:"/",children:Object(x.jsx)(Z,{sidebar:c,openSidebar:j})}),Object(x.jsx)(O.a,{path:"/login",children:Object(x.jsx)(X,{})})]})]})}):Object(x.jsx)(X,{})})},ce=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,395)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;c(e),a(e),s(e),n(e),i(e)}))};i.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(N,{initialState:{user:null},reducer:ee,children:Object(x.jsx)(te,{})})}),document.getElementById("root")),ce()}},[[374,1,2]]]);
//# sourceMappingURL=main.fe14afeb.chunk.js.map